{"format_version":"1.2","terraform_version":"1.10.5","planned_values":{"root_module":{"resources":[{"address":"aws_db_instance.compliant_database","mode":"managed","type":"aws_db_instance","name":"compliant_database","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"backup_retention_period":7,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"15.3","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"compliant-database","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"ChangeMeInProduction!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":true,"tags":{"Environment":"production"},"tags_all":{"Environment":"production"},"timeouts":null,"upgrade_storage_config":null,"username":"admin"},"sensitive_values":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}},{"address":"aws_db_instance.non_compliant_database","mode":"managed","type":"aws_db_instance","name":"non_compliant_database","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"backup_retention_period":3,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"15.3","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"insecure-database","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"ChangeMeInProduction!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":false,"tags":{"Environment":"development"},"tags_all":{"Environment":"development"},"timeouts":null,"upgrade_storage_config":null,"username":"admin"},"sensitive_values":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}},{"address":"aws_s3_bucket.compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"compliant_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"my-compliant-bucket-example","force_destroy":false,"tags":{"Compliance":"enabled","Environment":"production"},"tags_all":{"Compliance":"enabled","Environment":"production"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_s3_bucket.non_compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"non_compliant_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"my-insecure-bucket-example","force_destroy":false,"tags":{"Environment":"development"},"tags_all":{"Environment":"development"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_s3_bucket_public_access_block.compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"compliant_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.non_compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"non_compliant_access","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":false,"block_public_policy":false,"ignore_public_acls":false,"restrict_public_buckets":false},"sensitive_values":{}},{"address":"aws_s3_bucket_server_side_encryption_configuration.compliant_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"compliant_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_s3_bucket_versioning.compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"compliant_versioning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"sensitive_values":{"versioning_configuration":[{}]}},{"address":"aws_s3_bucket_versioning.non_compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"non_compliant_versioning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Disabled"}]},"sensitive_values":{"versioning_configuration":[{}]}}]}},"resource_changes":[{"address":"aws_db_instance.compliant_database","mode":"managed","type":"aws_db_instance","name":"compliant_database","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"backup_retention_period":7,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"15.3","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"compliant-database","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"ChangeMeInProduction!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":true,"tags":{"Environment":"production"},"tags_all":{"Environment":"production"},"timeouts":null,"upgrade_storage_config":null,"username":"admin"},"after_unknown":{"address":true,"arn":true,"availability_zone":true,"backup_target":true,"backup_window":true,"blue_green_update":[],"ca_cert_identifier":true,"character_set_name":true,"database_insights_mode":true,"db_name":true,"db_subnet_group_name":true,"domain_fqdn":true,"endpoint":true,"engine_lifecycle_support":true,"engine_version_actual":true,"hosted_zone_id":true,"id":true,"identifier_prefix":true,"iops":true,"kms_key_id":true,"latest_restorable_time":true,"license_model":true,"listener_endpoint":true,"maintenance_window":true,"master_user_secret":true,"master_user_secret_kms_key_id":true,"monitoring_role_arn":true,"multi_az":true,"nchar_character_set_name":true,"network_type":true,"option_group_name":true,"parameter_group_name":true,"performance_insights_kms_key_id":true,"performance_insights_retention_period":true,"port":true,"replica_mode":true,"replicas":true,"resource_id":true,"restore_to_point_in_time":[],"s3_import":[],"snapshot_identifier":true,"status":true,"storage_throughput":true,"storage_type":true,"tags":{},"tags_all":{},"timezone":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"aws_db_instance.non_compliant_database","mode":"managed","type":"aws_db_instance","name":"non_compliant_database","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"backup_retention_period":3,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"15.3","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"insecure-database","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"ChangeMeInProduction!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":false,"tags":{"Environment":"development"},"tags_all":{"Environment":"development"},"timeouts":null,"upgrade_storage_config":null,"username":"admin"},"after_unknown":{"address":true,"arn":true,"availability_zone":true,"backup_target":true,"backup_window":true,"blue_green_update":[],"ca_cert_identifier":true,"character_set_name":true,"database_insights_mode":true,"db_name":true,"db_subnet_group_name":true,"domain_fqdn":true,"endpoint":true,"engine_lifecycle_support":true,"engine_version_actual":true,"hosted_zone_id":true,"id":true,"identifier_prefix":true,"iops":true,"kms_key_id":true,"latest_restorable_time":true,"license_model":true,"listener_endpoint":true,"maintenance_window":true,"master_user_secret":true,"master_user_secret_kms_key_id":true,"monitoring_role_arn":true,"multi_az":true,"nchar_character_set_name":true,"network_type":true,"option_group_name":true,"parameter_group_name":true,"performance_insights_kms_key_id":true,"performance_insights_retention_period":true,"port":true,"replica_mode":true,"replicas":true,"resource_id":true,"restore_to_point_in_time":[],"s3_import":[],"snapshot_identifier":true,"status":true,"storage_throughput":true,"storage_type":true,"tags":{},"tags_all":{},"timezone":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"aws_s3_bucket.compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"compliant_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"my-compliant-bucket-example","force_destroy":false,"tags":{"Compliance":"enabled","Environment":"production"},"tags_all":{"Compliance":"enabled","Environment":"production"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_s3_bucket.non_compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"non_compliant_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"my-insecure-bucket-example","force_destroy":false,"tags":{"Environment":"development"},"tags_all":{"Environment":"development"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_s3_bucket_public_access_block.compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"compliant_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.non_compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"non_compliant_access","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":false,"block_public_policy":false,"ignore_public_acls":false,"restrict_public_buckets":false},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.compliant_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"compliant_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_s3_bucket_versioning.compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"compliant_versioning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Enabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}},{"address":"aws_s3_bucket_versioning.non_compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"non_compliant_versioning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Disabled"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}}],"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 5.0","expressions":{"region":{"constant_value":"us-east-1"}}}},"root_module":{"resources":[{"address":"aws_db_instance.compliant_database","mode":"managed","type":"aws_db_instance","name":"compliant_database","provider_config_key":"aws","expressions":{"allocated_storage":{"constant_value":20},"backup_retention_period":{"constant_value":7},"engine":{"constant_value":"postgres"},"engine_version":{"constant_value":"15.3"},"identifier":{"constant_value":"compliant-database"},"instance_class":{"constant_value":"db.t3.micro"},"password":{"constant_value":"ChangeMeInProduction!"},"skip_final_snapshot":{"constant_value":true},"storage_encrypted":{"constant_value":true},"tags":{"constant_value":{"Environment":"production"}},"username":{"constant_value":"admin"}},"schema_version":2},{"address":"aws_db_instance.non_compliant_database","mode":"managed","type":"aws_db_instance","name":"non_compliant_database","provider_config_key":"aws","expressions":{"allocated_storage":{"constant_value":20},"backup_retention_period":{"constant_value":3},"engine":{"constant_value":"postgres"},"engine_version":{"constant_value":"15.3"},"identifier":{"constant_value":"insecure-database"},"instance_class":{"constant_value":"db.t3.micro"},"password":{"constant_value":"ChangeMeInProduction!"},"skip_final_snapshot":{"constant_value":true},"storage_encrypted":{"constant_value":false},"tags":{"constant_value":{"Environment":"development"}},"username":{"constant_value":"admin"}},"schema_version":2},{"address":"aws_s3_bucket.compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"compliant_bucket","provider_config_key":"aws","expressions":{"bucket":{"constant_value":"my-compliant-bucket-example"},"tags":{"constant_value":{"Compliance":"enabled","Environment":"production"}}},"schema_version":0},{"address":"aws_s3_bucket.non_compliant_bucket","mode":"managed","type":"aws_s3_bucket","name":"non_compliant_bucket","provider_config_key":"aws","expressions":{"bucket":{"constant_value":"my-insecure-bucket-example"},"tags":{"constant_value":{"Environment":"development"}}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"compliant_access","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.compliant_bucket.id","aws_s3_bucket.compliant_bucket"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.non_compliant_access","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"non_compliant_access","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":false},"block_public_policy":{"constant_value":false},"bucket":{"references":["aws_s3_bucket.non_compliant_bucket.id","aws_s3_bucket.non_compliant_bucket"]},"ignore_public_acls":{"constant_value":false},"restrict_public_buckets":{"constant_value":false}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.compliant_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"compliant_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.compliant_bucket.id","aws_s3_bucket.compliant_bucket"]},"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"compliant_versioning","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.compliant_bucket.id","aws_s3_bucket.compliant_bucket"]},"versioning_configuration":[{"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.non_compliant_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"non_compliant_versioning","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.non_compliant_bucket.id","aws_s3_bucket.non_compliant_bucket"]},"versioning_configuration":[{"status":{"constant_value":"Disabled"}}]},"schema_version":0}]}},"relevant_attributes":[{"resource":"aws_s3_bucket.non_compliant_bucket","attribute":["id"]},{"resource":"aws_s3_bucket.compliant_bucket","attribute":["id"]}],"timestamp":"2026-02-06T17:52:59Z","applyable":true,"complete":true,"errored":false}
